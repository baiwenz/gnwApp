package com.example.mylibrary.model.Impl;

import com.example.commonlibrary.base.UrlConfig;
import com.example.commonlibrary.bean.Message;
import com.example.commonlibrary.http.RetrofitUtils;
import com.example.commonlibrary.interfaces.OnCallBackListener;
import com.example.commonlibrary.interfaces.OnRequestCallBackListener;
import com.example.mylibrary.model.LoginModel;
import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

import java.lang.reflect.Type;

public class LoginModelImpl implements LoginModel {
    @Override
    public void loadDate(final OnCallBackListener callBackListener) {

    }

    @Override
    public void postMsg(final OnCallBackListener callBackListener,String phoneNumber) {
        RetrofitUtils.postMsg(UrlConfig.POST_MSG,phoneNumber, new OnRequestCallBackListener<String>() {

            @Override
            public void onSuccess(String body, String tag) {
                Type type = new TypeToken<Message>() {}.getType();
                Gson gson = new Gson();
                Message message = gson.fromJson(body,type);
                callBackListener.onSuccess(message);
            }


            @Override
            public void onFailed(String e, String tag) {

            }
        });
    }
}
